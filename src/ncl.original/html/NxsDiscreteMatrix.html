<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head><title>NEXUS CLASS LIBRARY: NxsDiscreteMatrix Class</title>

<style type="text/css"> 
<!--
@import url(ncl.css);
.quickref {font-family: Arial, sans-serif}
.public {font-weight: bold; color: black; background: white;}
.protected {font-weight: bold; color: teal; background: white;}
.private {font-weight: bold; color: red; background: white;}
.groupheading {font-size: large; font-weight: bold;}
.classy {font-family: Arial, sans-serif; color: navy;}
.variablename {font-weight: bold; color: maroon;}
-->
</style>
</head>
<body>

<table border="1" width="100%">
<tr><td>
<table border="0" width="100%">
<tr>
<td align="left"><span class="classy">NEXUS CLASS LIBRARY</span></td>
<td align="right"><span class="classy"><a href="index.html">home</a> | <a href="classes.html">classes</a> | <a href="functions.html">functions</a></span></td>
</tr>
</table>
</td></tr>
</table>

<h1>Class NxsDiscreteMatrix</h1>

<h2>Friends</h2>
class <a href="NxsAllelesBlock.html"><span class="quickref">NxsAllelesBlock</span></a>, class <a href="NxsCharactersBlock.html"><span class="quickref">NxsCharactersBlock</span></a>
<h2>Data Members</h2>
<a href="#data"><span class="quickref">data</span></a>, <a href="#ncols"><span class="quickref">ncols</span></a>, <a href="#nrows"><span class="quickref">nrows</span></a>
<h2>Member Functions</h2>
<a href="#AddRows55"><span class="quickref">AddRows</span></a><a href="#AddState90"><span class="quickref">, AddState</span></a><a href="#AddState113"><span class="quickref">, AddState</span></a><a href="#CopyStatesFromFirstTaxon165"><span class="quickref">, CopyStatesFromFirstTaxon</span></a><a href="#DebugSaveMatrix182"><span class="quickref">, DebugSaveMatrix</span></a><a href="#DuplicateRow214"><span class="quickref">, DuplicateRow</span></a><a href="#Flush251"><span class="quickref">, Flush</span></a><a href="#GetDiscreteDatum269"><span class="quickref">, GetDiscreteDatum</span></a><a href="#GetNumStates287"><span class="quickref">, GetNumStates</span></a><a href="#GetNumStates303"><span class="quickref">, GetNumStates</span></a><a href="#GetObsNumStates320"><span class="quickref">, GetObsNumStates</span></a><a href="#GetState351"><span class="quickref">, GetState</span></a><a href="#GetState370"><span class="quickref">, GetState</span></a><a href="#IsGap386"><span class="quickref">, IsGap</span></a><a href="#IsGap403"><span class="quickref">, IsGap</span></a><a href="#IsMissing416"><span class="quickref">, IsMissing</span></a><a href="#IsMissing433"><span class="quickref">, IsMissing</span></a><a href="#IsPolymorphic446"><span class="quickref">, IsPolymorphic</span></a><a href="#IsPolymorphic463"><span class="quickref">, IsPolymorphic</span></a><a href="#NxsDiscreteMatrix26"><span class="quickref">, NxsDiscreteMatrix</span></a><a href="#NxsDiscreteMatrix41"><span class="quickref">, ~NxsDiscreteMatrix</span></a><a href="#Reset478"><span class="quickref">, Reset</span></a><a href="#SetGap509"><span class="quickref">, SetGap</span></a><a href="#SetGap526"><span class="quickref">, SetGap</span></a><a href="#SetMissing539"><span class="quickref">, SetMissing</span></a><a href="#SetMissing556"><span class="quickref">, SetMissing</span></a><a href="#SetPolymorphic570"><span class="quickref">, SetPolymorphic</span></a><a href="#SetPolymorphic589"><span class="quickref">, SetPolymorphic</span></a><a href="#SetState607"><span class="quickref">, SetState</span></a><a href="#SetState627"><span class="quickref">, SetState</span></a>
<h2>Class Description</h2>

<p>
Class providing storage for the discrete data types (dna, rna, nucleotide, standard, and protein) inside a DATA or  CHARACTERS block. This class is also used to store the data for an ALLELES block. Maintains a matrix in which each  cell is an object of the class  <a href="NxsDiscreteDatum.html">NxsDiscreteDatum</a> .  <a href="NxsDiscreteDatum.html">NxsDiscreteDatum</a>  stores the state for a particular combination of  taxon and character as an integer. Ordinarily, there will be a single state recorded for each taxon-character  combination, but exceptions exist if there is polymorphism for a taxon-character combination, or if there is  uncertainty about the state (e.g., in dna data, the data file might have contained an R or Y entry). Please consult  the documentation for the  <a href="NxsDiscreteDatum.html">NxsDiscreteDatum</a>  class for the details about how states are stored. For data stored in an  ALLELES block, rows of the matrix correspond to individuals and columns to loci. Each  <a href="NxsDiscreteDatum.html">NxsDiscreteDatum</a>  must  therefore store information about both genes at a single locus for a single individual in the case of diploid data. To do this, two macros HIWORD and LOWORD are used to divide up the unsigned value into two words. A maximum of 255  distinct allelic forms can be accommodated by this scheme, assuming at minimum a 32-bit architecture. Because it is not known in advance how many rows are going to be necessary, The NxsDiscreteMatrix class provides the AddRows  method, which expands the number of rows allocated for the matrix while preserving data already stored.


<h3>Key to symbols and colors</h3>

<p><span class="public">public</span>, <span class="protected">protected</span>, <span class="private">private</span>, <code>A</code> = abstract, <code>C</code> = constructor, <code>D</code> = destructor, <code>I</code> = inline, <code>S</code> = static, <code>V</code> = virtual, <code>F</code> = friend</p>
<p>&nbsp;</p>
<center>
<table border="5" cellpadding="1" cellspacing="0" width="95%">
<tr bgcolor="#CCCCFF">
<td><span class="groupheading">Data Members</span></td>
</table>
<table border="1" cellpadding="3" cellspacing="0" width="95%">
<tr><td>
<table  width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>&nbsp;<a href="NxsDiscreteDatum.html">NxsDiscreteDatum</a></code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="private"><a name="data">**data</a></code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>storage for the data</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table  width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>&nbsp;unsigned</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="private"><a name="ncols">ncols</a></code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>number of columns (characters) in the data matrix</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table  width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>&nbsp;unsigned</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="private"><a name="nrows">nrows</a></code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>number of rows (taxa) in the data matrix</dd></td>
</tr>
</table>
</td></tr>
</table>
</center>
<p>&nbsp;</p>
<center>
<table border="5" cellpadding="1" cellspacing="0" width="95%">
<tr bgcolor="#CCCCFF">
<td><span class="groupheading">Member Functions</span></td>
</table>
<table border="1" cellpadding="3" cellspacing="0" width="95%">
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="AddRows55">AddRows</a></code><code>(unsigned nAddRows)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Allocates memory for <span class="variablename">nAddRows</span> additional rows and updates the variable nrows. Data already stored in <span class="variablename">data</span> is not destroyed; the newly-allocated rows are added at the bottom of the existing matrix.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="AddState90">AddState</a></code><code>(unsigned i, unsigned j, unsigned value)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Adds state directly to the <a href="NxsDiscreteDatum.html">NxsDiscreteDatum</a> object at data[i][j]. Assumes <span class="variablename">data</span> is non-NULL, <span class="variablename">i</span> is in the range  [0..nrows), and <span class="variablename">j</span> is in the range [0..ncols). The <span class="variablename">value</span> argument is assumed to be either zero or a positive  integer. Calls private member function AddState to do the real work; look at the documentation for that function  for additional details.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="AddState113">AddState</a></code><code>(NxsDiscreteDatum &d, unsigned value)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Adds an additional state to the array states of <span class="variablename">d</span>. If <span class="variablename">states</span> is NULL, allocates memory for two integers and  assigns 1 to the first and <span class="variablename">value</span> to the second. If <span class="variablename">states</span> is non-NULL, allocates a new int array long enough to  hold states already present plus the new one being added here, then deletes the old <span class="variablename">states</span> array. Assumes that we  are not trying to set either the missing state or the gap state here; the functions SetMissing or SetGap,  respectively, should be used for those purposes. Also assumes that we do not want to overwrite the state. This  function always adds states to those already present; use SetState to overwrite the state.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="CopyStatesFromFirstTaxon165">CopyStatesFromFirstTaxon</a></code><code>(unsigned i, unsigned j)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Sets state of taxon <span class="variablename">i</span> and character <span class="variablename">j</span> to state of first taxon for character <span class="variablename">j</span>. Assumes <span class="variablename">i</span> is in the range  [0..nrows) and <span class="variablename">j</span> is in the range [0..ncols). Also assumes <span class="variablename">data</span> is non-NULL. Calls private function CopyFrom to do the actual work.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="DebugSaveMatrix182">DebugSaveMatrix</a></code><code>(ostream &out, unsigned colwidth)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Performs a dump of the current contents of the data matrix stored in the variable <span class="variablename">data</span>. Translates missing data elements to the '?' character and gap states to '-', otherwise, calls GetState to provide the representation.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>unsigned</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="DuplicateRow214">DuplicateRow</a></code><code>(unsigned row, unsigned count, unsigned startCol, unsigned endCol)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Duplicates columns <span class="variablename">startCol</span> to <span class="variablename">endCol</span> in row <span class="variablename">row</span> of the matrix. If additional storage is needed to accommodate the duplication, this is done automatically through the use of the AddRows method. Note that <span class="variablename">count</span> includes the  row already present, so if <span class="variablename">count</span> is 10, then 9 more rows will actually be added to the matrix to make a total of  10 identical rows. The parameters <span class="variablename">startCol</span> and <span class="variablename">endCol</span> default to 0 and <span class="variablename">ncols</span>, so if duplication of the entire row is needed, these need not be explicitly specified in the call to DuplicateRow. Return value is number of  additional rows allocated to matrix (0 if no rows needed to be allocated). Assumes <span class="variablename">data</span> is non-NULL, <span class="variablename">row</span> is in the range [[0..<span class="variablename">nrows</span>), <span class="variablename">startCol</span> is in the range [0..<span class="variablename">ncols</span>), and <span class="variablename">endCol</span> is either UINT_MAX, in which case it is reset to <span class="variablename">ncols</span> - 1, or is in the range (<span class="variablename">startCol</span>..<span class="variablename">ncols</span>).</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="Flush251">Flush</a></code><code>()</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Deletes all cells of <span class="variablename">data</span>, setting <span class="variablename">data</span> to NULL, and resets <span class="variablename">nrows</span> and <span class="variablename">ncols</span> to 0.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code><a href="NxsDiscreteDatum.html">NxsDiscreteDatum</a></code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="GetDiscreteDatum269">&GetDiscreteDatum</a></code><code>(unsigned i, unsigned j)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Assumes that <span class="variablename">data</span> is non-NULL, <span class="variablename">i</span> is in the range [0..<span class="variablename">nrows</span>) and <span class="variablename">j</span> is in the range [0..<span class="variablename">ncols</span>). Returns  reference to the <a href="NxsDiscreteDatum.html">NxsDiscreteDatum</a> object at row <span class="variablename">i</span>, column <span class="variablename">j</span> of matrix.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>unsigned</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="GetNumStates287">GetNumStates</a></code><code>(unsigned i, unsigned j)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns number of states for taxon <span class="variablename">i</span> and character <span class="variablename">j</span>. Assumes <span class="variablename">data</span> is non-NULL, <span class="variablename">i</span> is in the range  [0..<span class="variablename">nrows</span>), and <span class="variablename">j</span> is in the range [0..<span class="variablename">ncols</span>). Calls private member function GetNumStates to do the actual work.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>unsigned</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="GetNumStates303">GetNumStates</a></code><code>(NxsDiscreteDatum &d)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns total number of states assigned to <span class="variablename">d</span>. Returns 0 for both gap and missing states.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>unsigned</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="GetObsNumStates320">GetObsNumStates</a></code><code>(unsigned j)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns number of states for character <span class="variablename">j</span> over all taxa. Note: this function is rather slow, as it must walk  through each taxon for the specified character, adding the states encountered to a set, then finally returning the size of the set. Thus, if this function is called often, it would be advisable to initialize an array using this  function, then refer to the array subsequently. Assumes <span class="variablename">j</span> is in the range [0..<span class="variablename">ncols</span>) and <span class="variablename">data</span> is non-NULL. Includes all taxa (i.e. there is no mechanism here for treating some taxa as deleted for a particular analysis). Missing and gap states are ignored.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>unsigned</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="GetState351">GetState</a></code><code>(unsigned i, unsigned j, unsigned k)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns the <span class="variablename">k</span>th state possessed by taxon <span class="variablename">i</span> and character <span class="variablename">j</span>. This taxon-character combination will have more  than one state if there is ambiguity or polymorphism. Assumes that <span class="variablename">i</span> is in the range [0..<span class="variablename">nrows</span>) and <span class="variablename">j</span> is in  the range [0..<span class="variablename">ncols</span>). Also assumes that at least one state is present (i.e., not the gap or missing state). Use  the function GetNumStates to determine the  number of states present. Assumes <span class="variablename">k</span> is in the range [0..ns), where ns is the value returned by GetNumStates.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>unsigned</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="GetState370">GetState</a></code><code>(NxsDiscreteDatum &d, unsigned k)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns the internal unsigned representation of the state stored in <span class="variablename">d</span> at position <span class="variablename">k</span> of the array <span class="variablename">d.states</span>.  Assumes that the state is not the missing or gap state. Use IsMissing and IsGap prior to calling this function to  ensure this function will succeed. Assumes that <span class="variablename">k</span> is in the range [ 0 .. <span class="variablename">d.states</span>[0]).</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>bool</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="IsGap386">IsGap</a></code><code>(unsigned i, unsigned j)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns 1 if the state for taxon <span class="variablename">i</span>, character <span class="variablename">j</span>, is set to the gap symbol, 0 otherwise. Assumes <span class="variablename">data</span> is  non-NULL, <span class="variablename">i</span> is in the range [0..<span class="variablename">nrows</span>) and <span class="variablename">j</span> is in the range [0..<span class="variablename">ncols</span>).</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>bool</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="IsGap403">IsGap</a></code><code>(NxsDiscreteDatum &d)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns true if the gap state is stored, otherwise returns false. Note: returns false if this datum represents  missing data (often the gap state is equated with missing data, but the distinction is made here).</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>bool</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="IsMissing416">IsMissing</a></code><code>(unsigned i, unsigned j)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns 1 if the state for taxon <span class="variablename">i</span>, character <span class="variablename">j</span>, is set to the missing data symbol, 0 otherwise. Assumes <span class="variablename">i</span> is  in the range [0..<span class="variablename">nrows</span>) and <span class="variablename">j</span> is in the range [0..<span class="variablename">ncols</span>).</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>bool</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="IsMissing433">IsMissing</a></code><code>(NxsDiscreteDatum &d)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns true if the missing state is stored, false otherwise. Note that this function returns false if the gap state is stored (often the gap state is equated with missing data, but the distinction is maintained here).</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>bool</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="IsPolymorphic446">IsPolymorphic</a></code><code>(unsigned i, unsigned j)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns 1 if character <span class="variablename">j</span> is polymorphic in taxon <span class="variablename">i</span>, 0 otherwise. Assumes <span class="variablename">data</span> is non-NULL, <span class="variablename">i</span> is in the  range [0..<span class="variablename">nrows</span>) and <span class="variablename">j</span> is in the range [0..<span class="variablename">ncols</span>).</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>bool</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="IsPolymorphic463">IsPolymorphic</a></code><code>(NxsDiscreteDatum &d)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns true if the number of states is greater than 1 and polymorphism has been specified. Returns false if the  state stored is the missing state, the gap state, or if the number of states is 1.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>C</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code></code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="NxsDiscreteMatrix26">NxsDiscreteMatrix</a></code><code>(unsigned rows, unsigned cols)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Initializes <span class="variablename">nrows</span> to <span class="variablename">rows</span> and <span class="variablename">ncols</span> to <span class="variablename">cols</span>. In addition, memory is allocated for <span class="variablename">data</span> (each element of  the matrix <span class="variablename">data</span> is a <a href="NxsDiscreteDatum.html">NxsDiscreteDatum</a> object, which can do its own initialization).</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>D</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code></code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="NxsDiscreteMatrix41">~NxsDiscreteMatrix</a></code><code>()</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Deletes memory allocated in the constructor for data member <span class="variablename">data</span>.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="Reset478">Reset</a></code><code>(unsigned rows, unsigned cols)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Deletes all cells of <span class="variablename">data</span> and reallocates memory to create a new matrix object with <span class="variablename">nrows</span> = <span class="variablename">rows</span> and <span class="variablename">ncols</span>  = <span class="variablename">cols</span>. Assumes <span class="variablename">rows</span> and <span class="variablename">cols</span> are both greater than 0.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="SetGap509">SetGap</a></code><code>(unsigned i, unsigned j)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Sets state stored at `data[i][j]' to the gap state. Assumes <span class="variablename">i</span> is in the range [0..<span class="variablename">nrows</span>) and <span class="variablename">j</span> is in the  range [0..<span class="variablename">ncols</span>). Calls the private SetGap member function to do the actual work.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="SetGap526">SetGap</a></code><code>(NxsDiscreteDatum &d)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Assigns the gap state to <span class="variablename">d</span>, erasing any previously stored information. The gap state is designated internally as  a states array one element long, with the single element set to the value 0.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="SetMissing539">SetMissing</a></code><code>(unsigned i, unsigned j)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Sets state stored at `data[i][j]' to the missing state. Assumes <span class="variablename">data</span> is non-NULL, <span class="variablename">i</span> is in the range [0..<span class="variablename">nrows</span>) and <span class="variablename">j</span> is in the range [0..<span class="variablename">ncols</span>). Calls the private member function SetMissing to do the actual work.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="SetMissing556">SetMissing</a></code><code>(NxsDiscreteDatum &d)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Assigns the missing state to <span class="variablename">d</span>, erasing any previously stored information. The missing state is stored internally as a NULL value for the states array.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="SetPolymorphic570">SetPolymorphic</a></code><code>(unsigned i, unsigned j, unsigned value)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Specify 1 for <span class="variablename">value</span> if taxon at row <span class="variablename">i</span> is polymorphic at character in column <span class="variablename">j</span>, 0 for <span class="variablename">value</span> if uncertain  which state applies. Sets polymorphism state of taxon <span class="variablename">i</span> and character <span class="variablename">j</span> to <span class="variablename">value</span>. Assumes <span class="variablename">data</span> is non-NULL, <span class="variablename">i</span> is in the range [0..<span class="variablename">nrows</span>) and <span class="variablename">j</span> is in the range [0..<span class="variablename">ncols</span>). Also assumes that the number of states  stored is greater than 1. Calls private member function SetPolymorphic to do the actual work.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="SetPolymorphic589">SetPolymorphic</a></code><code>(NxsDiscreteDatum &d, unsigned value)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Sets the polymorphism cell (last cell in <span class="variablename">d.states</span>) to <span class="variablename">value</span>. Warning: has no effect if there are fewer than 2  states stored!</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="SetState607">SetState</a></code><code>(unsigned i, unsigned j, unsigned value)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Sets state of taxon <span class="variablename">i</span> and character <span class="variablename">j</span> to <span class="variablename">value</span>. Assumes <span class="variablename">data</span> is non-NULL, <span class="variablename">i</span> is in the range [0..<span class="variablename">nrows</span>)  and <span class="variablename">j</span> is in the range [0..<span class="variablename">ncols</span>). Assumes that this function will not be called if there is missing data or the  state is the gap state, in which case the functions SetMissing or SetGap, respectively, should be called instead. Calls the private member function SetState to do the actual work.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="SetState627">SetState</a></code><code>(NxsDiscreteDatum &d, unsigned value)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Assigns <span class="variablename">value</span> to the 2nd cell in <span class="variablename">d.states</span> (1st cell in <span class="variablename">d.states</span> array is set to 1 to indicate that there is  only one state). Warning: if already one or more states (including the gap state) are assigned to <span class="variablename">d</span>, they will  be forgotten. Use the function AddState if you want to preserve states already stored in <span class="variablename">d</span>. Assumes state being  set is not the missing state nor the gap state; use SetMissing or SetGap, respectively, for that.</dd></td>
</tr>
</table>
</td></tr>
</table>
</center>
