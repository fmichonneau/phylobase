<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head><title>NEXUS CLASS LIBRARY: NxsTreesBlock Class</title>

<style type="text/css"> 
<!--
@import url(ncl.css);
.quickref {font-family: Arial, sans-serif}
.public {font-weight: bold; color: black; background: white;}
.protected {font-weight: bold; color: teal; background: white;}
.private {font-weight: bold; color: red; background: white;}
.groupheading {font-size: large; font-weight: bold;}
.classy {font-family: Arial, sans-serif; color: navy;}
.variablename {font-weight: bold; color: maroon;}
-->
</style>
</head>
<body>

<table border="1" width="100%">
<tr><td>
<table border="0" width="100%">
<tr>
<td align="left"><span class="classy">NEXUS CLASS LIBRARY</span></td>
<td align="right"><span class="classy"><a href="index.html">home</a> | <a href="classes.html">classes</a> | <a href="functions.html">functions</a></span></td>
</tr>
</table>
</td></tr>
</table>

<h1>Class NxsTreesBlock</h1>

<h2>Data Members</h2>
<a href="#defaultTree"><span class="quickref">defaultTree</span></a>, <a href="#ntrees"><span class="quickref">ntrees</span></a>, <a href="#rooted"><span class="quickref">rooted</span></a>, <a href="#taxa"><span class="quickref">taxa</span></a>, <a href="#translateList"><span class="quickref">translateList</span></a>, <a href="#treeDescription"><span class="quickref">treeDescription</span></a>, <a href="#treeName"><span class="quickref">treeName</span></a>
<h2>Member Functions</h2>
<a href="#BriefReport542"><span class="quickref">BriefReport</span></a><a href="#GetNumDefaultTree371"><span class="quickref">, GetNumDefaultTree</span></a><a href="#GetNumTrees379"><span class="quickref">, GetNumTrees</span></a><a href="#GetTranslatedTreeDescription402"><span class="quickref">, GetTranslatedTreeDescription</span></a><a href="#GetTreeDescription461"><span class="quickref">, GetTreeDescription</span></a><a href="#GetTreeName388"><span class="quickref">, GetTreeName</span></a><a href="#HandleTreeDescription65"><span class="quickref">, HandleTreeDescription</span></a><a href="#IsDefaultTree474"><span class="quickref">, IsDefaultTree</span></a><a href="#IsRootedTree490"><span class="quickref">, IsRootedTree</span></a><a href="#NxsTreesBlock25"><span class="quickref">, NxsTreesBlock</span></a><a href="#NxsTreesBlock40"><span class="quickref">, ~NxsTreesBlock</span></a><a href="#Read185"><span class="quickref">, Read</span></a><a href="#ReplaceTaxaBlockPtr52"><span class="quickref">, ReplaceTaxaBlockPtr</span></a><a href="#Report503"><span class="quickref">, Report</span></a><a href="#Reset348"><span class="quickref">, Reset</span></a>
<h2>Class Description</h2>

<p>
This class handles reading and storage for the NEXUS block TREES. It overrides the member functions Read and Reset, which are abstract virtual functions in the base class  <a href="NxsBlock.html">NxsBlock</a> . The translation table (if one is supplied) is  stored in the <span class="variablename">translateList</span>. The tree names are stored in <span class="variablename">treeName</span> and the tree descriptions in  <span class="variablename">treeDescription</span>. Information about rooting of trees is stored in <span class="variablename">rooted</span>. Note that no checking is done to  ensure that the tree descriptions are valid. The validity of the tree descriptions could be checked after the TREES block has been read (but before the next block in the file has been read) by overriding the  <a href="NxsReader.html">NxsReader</a> ::ExitingBlock member function, but no functionality for this is provided by the NCL. Below is a table showing the correspondence between the elements of a TREES block and the variables and member functions that can be used to access each piece  of information stored. <pre> NEXUS command     Data members    Member functions
 -----------------------------------------------------
 TRANSLATE         translateList
 
 TREE              treeName        GetTreeName
                                   GetTreeDescription
                                   GetNumTrees
                                   GetNumDefaultTree
                                   IsDefaultTree
 
                   rooted          IsRootedTree
 -----------------------------------------------------
</pre>


<h3>Key to symbols and colors</h3>

<p><span class="public">public</span>, <span class="protected">protected</span>, <span class="private">private</span>, <code>A</code> = abstract, <code>C</code> = constructor, <code>D</code> = destructor, <code>I</code> = inline, <code>S</code> = static, <code>V</code> = virtual, <code>F</code> = friend</p>
<p>&nbsp;</p>
<center>
<table border="5" cellpadding="1" cellspacing="0" width="95%">
<tr bgcolor="#CCCCFF">
<td><span class="groupheading">Data Members</span></td>
</table>
<table border="1" cellpadding="3" cellspacing="0" width="95%">
<tr><td>
<table  width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>&nbsp;unsigned</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="defaultTree">defaultTree</a></code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>0-offset index of default tree specified by user, or 0 if user failed to specify a default tree using an asterisk in the NEXUS data file</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table  width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>&nbsp;unsigned</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="ntrees">ntrees</a></code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>number of trees stored</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table  width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>&nbsp;NxsBoolVector</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="rooted">rooted</a></code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>stores information about rooting for each tree</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table  width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>&nbsp;<a href="NxsTaxaBlock.html">NxsTaxaBlock</a></code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="taxa">*taxa</a></code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>pointer to existing NxsTaxaBlock object</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table  width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>&nbsp;NxsStringMap</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="translateList">translateList</a></code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>storage for translation table (if any)</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table  width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>&nbsp;NxsStringVector</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="treeDescription">treeDescription</a></code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>storage for tree descriptions</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table  width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>&nbsp;NxsStringVector</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="treeName">treeName</a></code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>storage for tree names</dd></td>
</tr>
</table>
</td></tr>
</table>
</center>
<p>&nbsp;</p>
<center>
<table border="5" cellpadding="1" cellspacing="0" width="95%">
<tr bgcolor="#CCCCFF">
<td><span class="groupheading">Member Functions</span></td>
</table>
<table border="1" cellpadding="3" cellspacing="0" width="95%">
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>V</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="BriefReport542">BriefReport</a></code><code>(NxsString &s)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Outputs a brief description of this block's contents to the referenced <a href="NxsString.html">NxsString</a>. An example of the output of this  command is shown below:<pre> TREES block contains 102 trees
</pre></dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>unsigned</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="GetNumDefaultTree371">GetNumDefaultTree</a></code><code>()</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns the 0-offset index of the default tree, which will be 0 if there is only one tree stored or no trees  stored. If more than one tree is stored, the default tree will be the one specifically indicated by the user (using an asterisk in the data file), or 0 if the user failed to specify.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>unsigned</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="GetNumTrees379">GetNumTrees</a></code><code>()</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns the number of trees stored in this NxsTreesBlock object.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code><a href="NxsString.html">NxsString</a></code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="GetTranslatedTreeDescription402">GetTranslatedTreeDescription</a></code><code>(unsigned i)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns the description of the tree stored at position <span class="variablename">i</span> in <span class="variablename">treeName</span>. Assumes that <span class="variablename">i</span> will be in the range  [0..ntrees). Node numbers will be translated to names in the resulting tree description. Use GetTreeDescription if  translation is not desired.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code><a href="NxsString.html">NxsString</a></code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="GetTreeDescription461">GetTreeDescription</a></code><code>(unsigned i)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns the description of the tree stored at position <span class="variablename">i</span> in <span class="variablename">treeDescription</span>. Assumes that <span class="variablename">i</span> will be in the  range [0..<span class="variablename">ntrees</span>).</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code><a href="NxsString.html">NxsString</a></code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="GetTreeName388">GetTreeName</a></code><code>(unsigned i)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns the name of the tree stored at position <span class="variablename">i</span> in <span class="variablename">treeName</span>. Assumes that <span class="variablename">i</span> will be in the range  [0..<span class="variablename">ntrees</span>).</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="HandleTreeDescription65">HandleTreeDescription</a></code><code>(NxsToken &token, bool utree)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Takes control from the Read member function when a TREE or UTREE command is encountered. If a TREE command is found, the HandleTreeDescription member function is called with <span class="variablename">utree</span> equal to false. If a UTREE command is found,  <span class="variablename">utree</span> equals true.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>bool</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="IsDefaultTree474">IsDefaultTree</a></code><code>(unsigned i)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns true if the <span class="variablename">i</span>th tree (0-offset) is the default tree, false otherwise. Assumes that <span class="variablename">i</span> will be in the  range [0..ntrees).</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>bool</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="IsRootedTree490">IsRootedTree</a></code><code>(unsigned i)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Returns true if the <span class="variablename">i</span>th tree (0-offset) is rooted, false otherwise. Assumes that <span class="variablename">i</span> will be in the  range [0..ntrees).</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>C</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code></code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="NxsTreesBlock25">NxsTreesBlock</a></code><code>(NxsTaxaBlock *tb)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Initializes <span class="variablename">id</span> to "TREES", <span class="variablename">ntrees</span> to 0, <span class="variablename">defaultTree</span> to 0, and <span class="variablename">taxa</span> to <span class="variablename">tb</span>. Assumes <span class="variablename">tb</span> is non-NULL.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>D</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code></code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="NxsTreesBlock40">~NxsTreesBlock</a></code><code>()</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Clears <span class="variablename">translateList</span>, <span class="variablename">rooted</span>, <span class="variablename">treeName</span> and <span class="variablename">treeDescription</span>.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>V</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="Read185">Read</a></code><code>(NxsToken &token)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>This function provides the ability to read everything following the block name (which is read by the <a href="NxsReader.html">NxsReader</a>  object) to the END or ENDBLOCK command. Characters are read from the input stream <span class="variablename">in</span>. Overrides the abstract  virtual function in the base class.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="ReplaceTaxaBlockPtr52">ReplaceTaxaBlockPtr</a></code><code>(NxsTaxaBlock *tb)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Makes data member <span class="variablename">taxa</span> point to <span class="variablename">tb</span> rather than the <a href="NxsTaxaBlock.html">NxsTaxaBlock</a> object it was previously pointing to. Assumes  <span class="variablename">tb</span> is non-NULL.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>V</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="Report503">Report</a></code><code>(ostream &out)</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>This function outputs a brief report of the contents of this block. Overrides the abstract virtual function in the  base class.</dd></td>
</tr>
</table>
</td></tr>
<tr><td>
<table width="100%" border="0" cellpadding="1">
<tr>
<td>V</td>
<td>&nbsp;</td>
<td align="right" valign="top" width="15%"><code>void</code></td>
<td>&nbsp;</td>
<td align="left" valign="top" width="82%"><code class="public"><a name="Reset348">Reset</a></code><code>()</code></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><dd>Flushes <span class="variablename">treeName</span>, <span class="variablename">treeDescription</span>, <span class="variablename">translateList</span> and <span class="variablename">rooted</span>, and sets <span class="variablename">ntrees</span> and <span class="variablename">defaultTree</span> both to 0 in preparation for reading a new TREES block.</dd></td>
</tr>
</table>
</td></tr>
</table>
</center>
